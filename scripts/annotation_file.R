
cluster_annotation <- 
  c("Axillary lymph nodes_Cluster-0" = "Endothelium",
    "Axillary lymph nodes_Cluster-1" = "Endothelium",
    "Axillary lymph nodes_Cluster-2" = "Endothelium",
    "Axillary lymph nodes_Cluster-3" = "Endothelium",
    "Axillary lymph nodes_Cluster-4" = "Endothelium",
    "Axillary lymph nodes_Cluster-5" = "Endothelium",
    "Axillary lymph nodes_Cluster-6" = "Endothelium",
    "Axillary lymph nodes_Cluster-7" = "Endothelium",
    "Axillary lymph nodes_Cluster-8" = "Endothelium",
    "Axillary lymph nodes_Cluster-9" = "Endothelium",
    "Axillary lymph nodes_Cluster-10" = "Endothelium",
    "Axillary lymph nodes_Cluster-11" = "Endothelium",
    "Axillary lymph nodes_Cluster-12" = "B-cell",
    "Axillary lymph nodes_Cluster-13" = "Endothelium",
    
    "Breast_Cluster-0" = "Epithelium",
    "Breast_Cluster-1" = "Epithelium",
    "Breast_Cluster-2" = "Epithelium",
    "Breast_Cluster-3" = "Epithelium",
    "Breast_Cluster-4" = "Epithelium",
    "Breast_Cluster-5" = "Epithelium",
    "Breast_Cluster-6" = "Epithelium",
    "Breast_Cluster-7" = "Epithelium",
    "Breast_Cluster-8" = "Epithelium",
    "Breast_Cluster-9" = "Epithelium",
    "Breast_Cluster-10" = "Epithelium",
    "Breast_Cluster-11" = "Epithelium",
    "Breast_Cluster-12" = "Epithelium",
    "Breast_Cluster-13" = "Epithelium",
    "Breast_Cluster-14" = "Epithelium",
    "Breast_Cluster-15" = "Epithelium",
    "Breast_Cluster-16" = "Unknown",
    "Breast_Cluster-17" = "Unknown",
    
    "Colon_Cluster-0" = "Epithelium",
    "Colon_Cluster-1" = "Epithelium",
    "Colon_Cluster-2" = "Epithelium",
    "Colon_Cluster-3" = "Epithelium",
    "Colon_Cluster-4" = "Epithelium",
    "Colon_Cluster-5" = "Epithelium",
    "Colon_Cluster-6" = "Epithelium",
    "Colon_Cluster-7" = "Epithelium",
    "Colon_Cluster-8" = "Epithelium",
    "Colon_Cluster-9" = "Epithelium",
    "Colon_Cluster-10" = "Epithelium",
    
    "Colon 2_Cluster-0" = "Epithelium",
    "Colon 2_Cluster-1" = "Epithelium",
    "Colon 2_Cluster-2" = "Epithelium",
    "Colon 2_Cluster-3" = "Epithelium",
    "Colon 2_Cluster-4" = "T/NK-cell",
    "Colon 2_Cluster-5" = "Epithelium",
    "Colon 2_Cluster-6" = "Epithelium",
    "Colon 2_Cluster-7" = "Epithelium",
    "Colon 2_Cluster-8" = "Epithelium",
    "Colon 2_Cluster-9" = "Epithelium",
    "Colon 2_Cluster-10" = "Epithelium",
    "Colon 2_Cluster-11" = "Epithelium",
    "Colon 2_Cluster-12" = "B-cell",
    "Colon 2_Cluster-13" = "Epithelium",
    "Colon 2_Cluster-14" = "Epithelium",
    "Colon 2_Cluster-15" = "Basophil",
    
    "Eyes_Cluster-0" = "Unknown",
    "Eyes_Cluster-1" = "Unknown",
    "Eyes_Cluster-2" = "Unknown",
    "Eyes_Cluster-3" = "Unknown",
    "Eyes_Cluster-4" = "Unknown",
    "Eyes_Cluster-5" = "Unknown",
    "Eyes_Cluster-6" = "Unknown",
    "Eyes_Cluster-7" = "Unknown",
    "Eyes_Cluster-8" = "Unknown",
    "Eyes_Cluster-9" = "Unknown",
    "Eyes_Cluster-10" = "Unknown",
    "Eyes_Cluster-11" = "Endothelium",
    
    "Eyes macula_Cluster-0" = "T-cell",
    "Eyes macula_Cluster-1" = "Unknown",
    "Eyes macula_Cluster-2" = "Unknown",
    "Eyes macula_Cluster-3" = "Unknown",
    "Eyes macula_Cluster-4" = "Unknown",
    "Eyes macula_Cluster-5" = "Unknown",
    "Eyes macula_Cluster-6" = "Unknown",
    "Eyes macula_Cluster-7" = "Unknown",
    "Eyes macula_Cluster-8" = "Monocyte",
    "Eyes macula_Cluster-9" = "Unknown",
    "Eyes macula_Cluster-10" = "B-cell",
    "Eyes macula_Cluster-11" = "Unknown",
    "Eyes macula_Cluster-12" = "Endothelium",
    
    "Eyes peripheral_Cluster-0" = "Unknown",
    "Eyes peripheral_Cluster-1" = "Unknown",
    "Eyes peripheral_Cluster-2" = "Unknown",
    "Eyes peripheral_Cluster-3" = "Unknown",
    "Eyes peripheral_Cluster-4" = "T/NK-cell",
    "Eyes peripheral_Cluster-5" = "Unknown",
    "Eyes peripheral_Cluster-6" = "Unknown",
    "Eyes peripheral_Cluster-7" = "Endothelium",
    "Eyes peripheral_Cluster-8" = "B/DC",
    "Eyes peripheral_Cluster-9" = "Unknown",
    "Eyes peripheral_Cluster-10" = "Basophil",
    "Eyes peripheral_Cluster-11" = "Unknown",
    
    "Head and neck lymph nodes_Cluster-0" = "Endothelium",
    "Head and neck lymph nodes_Cluster-1" = "Endothelium",
    "Head and neck lymph nodes_Cluster-2" = "Endothelium",
    "Head and neck lymph nodes_Cluster-3" = "Endothelium",
    "Head and neck lymph nodes_Cluster-4" = "Endothelium",
    "Head and neck lymph nodes_Cluster-5" = "Endothelium",
    "Head and neck lymph nodes_Cluster-6" = "Endothelium",
    "Head and neck lymph nodes_Cluster-7" = "Endothelium",
    "Head and neck lymph nodes_Cluster-8" = "Endothelium",
    "Head and neck lymph nodes_Cluster-9" = "Endothelium",
    "Head and neck lymph nodes_Cluster-10" = "Endothelium",
    "Head and neck lymph nodes_Cluster-11" = "Endothelium",
    
    "Heart_Cluster-0" = "Unknown",
    "Heart_Cluster-1" = "Unknown",
    "Heart_Cluster-2" = "Unknown",
    "Heart_Cluster-3" = "Endothelium",
    "Heart_Cluster-4" = "Endothelium/DC",
    "Heart_Cluster-5" = "Endothelium",
    "Heart_Cluster-6" = "Endothelium",
    "Heart_Cluster-7" = "Unknown",
    "Heart_Cluster-8" = "Unknown",
    "Heart_Cluster-9" = "Unknown",
    
    "Ileum_Cluster-0" = "Epithelium",
    "Ileum_Cluster-1" = "Epithelium",
    "Ileum_Cluster-2" = "Epithelium",
    "Ileum_Cluster-3" = "Epithelium",
    "Ileum_Cluster-4" = "Epithelium",
    "Ileum_Cluster-5" = "Epithelium",
    "Ileum_Cluster-6" = "Epithelium",
    "Ileum_Cluster-7" = "Epithelium",
    "Ileum_Cluster-8" = "Epithelium",
    "Ileum_Cluster-9" = "Epithelium",
    "Ileum_Cluster-10" = "Epithelium",
    "Ileum_Cluster-11" = "Epithelium",
    
    "Kidney_Cluster-0" = "Unknown",
    "Kidney_Cluster-1" = "Unknown",
    "Kidney_Cluster-2" = "Unknown",
    "Kidney_Cluster-3" = "Unknown",
    "Kidney_Cluster-4" = "Unknown",
    "Kidney_Cluster-5" = "Unknown",
    "Kidney_Cluster-6" = "Unknown",
    "Kidney_Cluster-7" = "T/NK-cell",
    "Kidney_Cluster-8" = "Monocyte",
    "Kidney_Cluster-9" = "Unknown",
    "Kidney_Cluster-10" = "Epithelium",
    "Kidney_Cluster-11" = "B-cell",
    
    "Liver_Cluster-0" = "T-cell",
    "Liver_Cluster-1" = "Unknown",
    "Liver_Cluster-2" = "Monocyte",
    "Liver_Cluster-3" = "Endothelium",
    "Liver_Cluster-4" = "Unknown",
    "Liver_Cluster-5" = "Unknown",
    "Liver_Cluster-6" = "Unknown",
    "Liver_Cluster-7" = "B-cell",
    "Liver_Cluster-8" = "NK-cell",
    "Liver_Cluster-9" = "Unknown",
    "Liver_Cluster-10" = "Monocyte",
    "Liver_Cluster-11" = "NK-cell",
    "Liver_Cluster-12" = "Unknown",
    "Liver_Cluster-13" = "Endothelium",
    "Liver_Cluster-14" = "B-cell",
    "Liver_Cluster-15" = "Epithelium",
    "Liver_Cluster-16" = "T-cell",
    "Liver_Cluster-17" = "Unknown",
    
    "Liver hep- CD45-_Cluster-0" = "Unknown",
    "Liver hep- CD45-_Cluster-1" = "T-cell",
    "Liver hep- CD45-_Cluster-2" = "Monocyte",
    "Liver hep- CD45-_Cluster-3" = "T-cell",
    "Liver hep- CD45-_Cluster-4" = "Monocyte",
    "Liver hep- CD45-_Cluster-5" = "Epithelium",
    "Liver hep- CD45-_Cluster-6" = "Endothelium",
    "Liver hep- CD45-_Cluster-7" = "NK-cell",
    "Liver hep- CD45-_Cluster-8" = "NK-cell",
    "Liver hep- CD45-_Cluster-9" = "Endothelium",
    "Liver hep- CD45-_Cluster-10" = "Endothelium",
    "Liver hep- CD45-_Cluster-11" = "Unknown",
    "Liver hep- CD45-_Cluster-12" = "B-cell",
    "Liver hep- CD45-_Cluster-13" = "Endothelium",
    "Liver hep- CD45-_Cluster-14" = "B-cell",
    "Liver hep- CD45-_Cluster-15" = "Unknown",
    
    "Liver hep- CD45+_Cluster-0" = "NK-cell",
    "Liver hep- CD45+_Cluster-1" = "T-cell",
    "Liver hep- CD45+_Cluster-2" = "T-cell",
    "Liver hep- CD45+_Cluster-3" = "Monocyte",
    "Liver hep- CD45+_Cluster-4" = "T-cell",
    "Liver hep- CD45+_Cluster-5" = "NK-cell",
    "Liver hep- CD45+_Cluster-6" = "Monocyte",
    "Liver hep- CD45+_Cluster-7" = "T-cell",
    "Liver hep- CD45+_Cluster-8" = "Monocyte",
    "Liver hep- CD45+_Cluster-9" = "B-cell",
    "Liver hep- CD45+_Cluster-10" = "T-cell",
    "Liver hep- CD45+_Cluster-11" = "Endothelium",
    "Liver hep- CD45+_Cluster-12" = "T/NK-cell",
    "Liver hep- CD45+_Cluster-13" = "Dendritic cell",
    "Liver hep- CD45+_Cluster-14" = "B/T-cell",
    
    "Lung_Cluster-0" = "Monocyte",
    "Lung_Cluster-1" = "Endothelium",
    "Lung_Cluster-2" = "Monocyte",
    "Lung_Cluster-3" = "B/T-cell",
    "Lung_Cluster-4" = "Granulocytes",
    "Lung_Cluster-5" = "Epithelium",
    "Lung_Cluster-6" = "Granulocytes",
    "Lung_Cluster-7" = "Epithelium",
    "Lung_Cluster-8" = "Epithelium",
    "Lung_Cluster-9" = "Endothelium",
    "Lung_Cluster-10" = "Epithelium",
    
    "Muscle_Cluster-0" = "Endothelium",
    "Muscle_Cluster-1" = "Unknown",
    "Muscle_Cluster-2" = "Unknown",
    "Muscle_Cluster-3" = "B/T/DC",
    "Muscle_Cluster-4" = "Unknown",
    "Muscle_Cluster-5" = "Endothelium",
    "Muscle_Cluster-6" = "Unknown",
    "Muscle_Cluster-7" = "Unknown",
    
    "NK cells blood_Cluster-0" = "NK-cell",
    "NK cells blood_Cluster-1" = "NK-cell",
    "NK cells blood_Cluster-2" = "NK-cell",
    "NK cells blood_Cluster-3" = "NK-cell",
    "NK cells blood_Cluster-4" = "NK-cell",
    "NK cells blood_Cluster-5" = "NK-cell",
    
    "NK cells bone marrow_Cluster-0" = "NK-cell",
    "NK cells bone marrow_Cluster-1" = "NK-cell",
    "NK cells bone marrow_Cluster-2" = "NK-cell",
    "NK cells bone marrow_Cluster-3" = "NK-cell",
    "NK cells bone marrow_Cluster-4" = "NK-cell",
    "NK cells bone marrow_Cluster-5" = "NK-cell",
    "NK cells bone marrow_Cluster-6" = "NK-cell",
    "NK cells bone marrow_Cluster-7" = "NK-cell",
    "NK cells bone marrow_Cluster-8" = "Dendritic cell",
    
    "PBMCs_Cluster-0" = "Monocyte",
    "PBMCs_Cluster-1" = "T-cell",
    "PBMCs_Cluster-2" = "T-cell",
    "PBMCs_Cluster-3" = "T-cell",
    "PBMCs_Cluster-4" = "T-cell",
    "PBMCs_Cluster-5" = "Unknown",
    "PBMCs_Cluster-6" = "T-cell",
    "PBMCs_Cluster-7" = "Monocyte",
    "PBMCs_Cluster-8" = "B-cell",
    "PBMCs_Cluster-9" = "Monocyte",
    "PBMCs_Cluster-10" = "Dendritic cell",
    "PBMCs_Cluster-11" = "Unknown",
    
    "Placenta_Cluster-0" = "Unknown",
    "Placenta_Cluster-1" = "Unknown",
    "Placenta_Cluster-2" = "Unknown",
    "Placenta_Cluster-3" = "Unknown",
    "Placenta_Cluster-4" = "Unknown",
    "Placenta_Cluster-5" = "Unknown",
    "Placenta_Cluster-6" = "Trophoblast",
    "Placenta_Cluster-7" = "Unknown",
    "Placenta_Cluster-8" = "Unknown",
    "Placenta_Cluster-9" = "Trophoblast",
    "Placenta_Cluster-10" = "Unknown",
    "Placenta_Cluster-11" = "Epithelium",
    "Placenta_Cluster-12" = "Unknown",
    "Placenta_Cluster-13" = "Unknown",
    "Placenta_Cluster-14" = "Unknown",
    "Placenta_Cluster-15" = "Unknown",
    "Placenta_Cluster-16" = "Unknown",
    "Placenta_Cluster-17" = "Unknown",
    "Placenta_Cluster-18" = "Unknown",
    "Placenta_Cluster-19" = "Endothelium",
    "Placenta_Cluster-20" = "Epithelium",
    
    "Placenta blood_Cluster-0" = "T-cell",
    "Placenta blood_Cluster-1" = "T-cell",
    "Placenta blood_Cluster-2" = "T/NK-cell",
    "Placenta blood_Cluster-3" = "T-cell",
    "Placenta blood_Cluster-4" = "T-cell",
    "Placenta blood_Cluster-5" = "Monocyte",
    "Placenta blood_Cluster-6" = "T-cell",
    "Placenta blood_Cluster-7" = "Monocyte",
    "Placenta blood_Cluster-8" = "T/NK-cell",
    "Placenta blood_Cluster-9" = "T-cell/Granulocyte",
    "Placenta blood_Cluster-10" = "Dendritic cell",
    "Placenta blood_Cluster-11" = "Monocyte",
    
    "Prostate_Cluster-0" = "Epithelium",
    "Prostate_Cluster-1" = "Epithelium",
    "Prostate_Cluster-2" = "Epithelium",
    "Prostate_Cluster-3" = "Unknown",
    "Prostate_Cluster-4" = "Epithelium",
    "Prostate_Cluster-5" = "Endothelium",
    "Prostate_Cluster-6" = "Unknown",
    "Prostate_Cluster-7" = "Epithelium",
    "Prostate_Cluster-8" = "Epithelium",
    "Prostate_Cluster-9" = "Epithelium",
    "Prostate_Cluster-10" = "Epithelium",
    "Prostate_Cluster-11" = "Unknown",
    "Prostate_Cluster-12" = "Epithelium",
    "Prostate_Cluster-13" = "Endothelium",
    "Prostate_Cluster-14" = "Unknown",
    "Prostate_Cluster-15" = "Epithelium",
    
    "Prostate 2_Cluster-0" = "Epithelium",
    "Prostate 2_Cluster-1" = "Endothelium",
    "Prostate 2_Cluster-2" = "Epithelium",
    "Prostate 2_Cluster-3" = "Unknown",
    "Prostate 2_Cluster-4" = "Epithelium",
    "Prostate 2_Cluster-5" = "Unknown",
    "Prostate 2_Cluster-6" = "Epithelium",
    "Prostate 2_Cluster-7" = "Epithelium",
    "Prostate 2_Cluster-8" = "Epithelium",
    "Prostate 2_Cluster-9" = "Endothelium",
    "Prostate 2_Cluster-10" = "Epithelium",
    "Prostate 2_Cluster-11" = "Endothelium",
    "Prostate 2_Cluster-12" = "Epithelium",
    
    "Prostate 3_Cluster-0" = "Epithelium",
    "Prostate 3_Cluster-1" = "Epithelium",
    "Prostate 3_Cluster-2" = "Epithelium",
    "Prostate 3_Cluster-3" = "Epithelium",
    "Prostate 3_Cluster-4" = "Epithelium",
    "Prostate 3_Cluster-5" = "Epithelium",
    "Prostate 3_Cluster-6" = "Epithelium",
    "Prostate 3_Cluster-7" = "Epithelium",
    "Prostate 3_Cluster-8" = "Epithelium",
    "Prostate 3_Cluster-9" = "Endothelium",
    "Prostate 3_Cluster-10" = "Epithelium",
    "Prostate 3_Cluster-11" = "Unknown",
    "Prostate 3_Cluster-12" = "Unknown",
    "Prostate 3_Cluster-13" = "Epithelium",
    "Prostate 3_Cluster-14" = "Epithelium",
    "Prostate 3_Cluster-15" = "Monocyte",
    "Prostate 3_Cluster-16" = "T-cell/Granulocyte",
    
    "Rectum_Cluster-0" = "Epithelium",
    "Rectum_Cluster-1" = "Epithelium",
    "Rectum_Cluster-2" = "Epithelium",
    "Rectum_Cluster-3" = "Epithelium",
    "Rectum_Cluster-4" = "Epithelium",
    "Rectum_Cluster-5" = "Epithelium",
    "Rectum_Cluster-6" = "Epithelium",
    "Rectum_Cluster-7" = "Epithelium",
    "Rectum_Cluster-8" = "Epithelium",
    "Rectum_Cluster-9" = "Epithelium",
    "Rectum_Cluster-10" = "Epithelium",
    "Rectum_Cluster-11" = "Epithelium",
    
    "Testis_Cluster-0" = "Unknown",
    "Testis_Cluster-1" = "Unknown",
    "Testis_Cluster-2" = "Unknown",
    "Testis_Cluster-3" = "Epithelium",
    "Testis_Cluster-4" = "Epithelium",
    "Testis_Cluster-5" = "Unknown",
    "Testis_Cluster-6" = "Unknown",
    "Testis_Cluster-7" = "Epithelium",
    "Testis_Cluster-8" = "Endothelium",
    "Testis_Cluster-9" = "Endothelium",
    "Testis_Cluster-10" = "Unknown",
    "Testis_Cluster-11" = "Epithelium",
    "Testis_Cluster-12" = "Epithelium",
    "Testis_Cluster-13" = "Unknown",
    "Testis_Cluster-14" = "Unknown",
    "Testis_Cluster-15" = "Monocyte/DC",
    "Testis_Cluster-16" = "Endothelium",
    "Testis_Cluster-17" = "Unknown",
    "Testis_Cluster-18" = "Unknown",
    "Testis_Cluster-19" = "Unknown",
    "Testis_Cluster-20" = "Unknown",
    
    "Testis 2_Cluster-0" = "Unknown",
    "Testis 2_Cluster-1" = "Endothelium",
    "Testis 2_Cluster-2" = "Unknown",
    "Testis 2_Cluster-3" = "Unknown",
    "Testis 2_Cluster-4" = "Unknown",
    "Testis 2_Cluster-5" = "Unknown",
    "Testis 2_Cluster-6" = "Epithelium",
    "Testis 2_Cluster-7" = "Unknown",
    "Testis 2_Cluster-8" = "Unknown",
    "Testis 2_Cluster-9" = "Monocyte",
    "Testis 2_Cluster-10" = "Endothelium",
    "Testis 2_Cluster-11" = "Unknown",
    "Testis 2_Cluster-12" = "Unknown",
    "Testis 2_Cluster-13" = "Unknown",
    "Testis 2_Cluster-14" = "Unknown",
    "Testis 2_Cluster-15" = "Unknown",
    "Testis 2_Cluster-16" = "Unknown",
    
    "Testis 3_Cluster-0" = "Unknown",
    "Testis 3_Cluster-1" = "Unknown",
    "Testis 3_Cluster-2" = "Unknown",
    "Testis 3_Cluster-3" = "Endothelium",
    "Testis 3_Cluster-4" = "Monocyte",
    "Testis 3_Cluster-5" = "Unknown",
    "Testis 3_Cluster-6" = "Unknown",
    "Testis 3_Cluster-7" = "Epithelium",
    "Testis 3_Cluster-8" = "Unknown",
    "Testis 3_Cluster-9" = "Unknown",
    "Testis 3_Cluster-10" = "Unknown",
    "Testis 3_Cluster-11" = "Unknown",
    "Testis 3_Cluster-12" = "Endothelium",
    "Testis 3_Cluster-13" = "T-cell") %>% 
  enframe("cluster", "cluster_annotation") %>% 
  separate(cluster, into = c("dataset", "cluster_id"), sep = "_", remove = F) %>%
  mutate(celltype = case_when(cluster_annotation %in% c("Too few cells", "Unknown") ~ "Unknown",
                              T ~ cluster_annotation)) %>% 
  group_by(celltype) %>%
  mutate(unique_cluster_id = paste(celltype, row_number())) %>%
  ungroup() %>% 
  left_join(c("Axillary lymph nodes_Cluster-0" = "",
              "Axillary lymph nodes_Cluster-1" = "",
              "Axillary lymph nodes_Cluster-2" = "",
              "Axillary lymph nodes_Cluster-3" = "",
              "Axillary lymph nodes_Cluster-4" = "",
              "Axillary lymph nodes_Cluster-5" = "",
              "Axillary lymph nodes_Cluster-6" = "",
              "Axillary lymph nodes_Cluster-7" = "",
              "Axillary lymph nodes_Cluster-8" = "",
              "Axillary lymph nodes_Cluster-9" = "",
              "Axillary lymph nodes_Cluster-10" = "",
              "Axillary lymph nodes_Cluster-11" = "",
              "Axillary lymph nodes_Cluster-12" = "",
              "Axillary lymph nodes_Cluster-13" = "",
              
              "Breast_Cluster-0" = "",
              "Breast_Cluster-1" = "",
              "Breast_Cluster-2" = "",
              "Breast_Cluster-3" = "",
              "Breast_Cluster-4" = "",
              "Breast_Cluster-5" = "",
              "Breast_Cluster-6" = "",
              "Breast_Cluster-7" = "",
              "Breast_Cluster-8" = "",
              "Breast_Cluster-9" = "",
              "Breast_Cluster-10" = "",
              "Breast_Cluster-11" = "",
              "Breast_Cluster-12" = "",
              "Breast_Cluster-13" = "",
              "Breast_Cluster-14" = "",
              "Breast_Cluster-15" = "Maybe immune cell mix",
              "Breast_Cluster-16" = "",
              "Breast_Cluster-17" = "",
              
              "Colon_Cluster-0" = "",
              "Colon_Cluster-1" = "",
              "Colon_Cluster-2" = "",
              "Colon_Cluster-3" = "",
              "Colon_Cluster-4" = "",
              "Colon_Cluster-5" = "",
              "Colon_Cluster-6" = "",
              "Colon_Cluster-7" = "",
              "Colon_Cluster-8" = "",
              "Colon_Cluster-9" = "",
              "Colon_Cluster-10" = "",
              
              "Colon 2_Cluster-0" = "",
              "Colon 2_Cluster-1" = "",
              "Colon 2_Cluster-2" = "",
              "Colon 2_Cluster-3" = "",
              "Colon 2_Cluster-4" = "",
              "Colon 2_Cluster-5" = "",
              "Colon 2_Cluster-6" = "",
              "Colon 2_Cluster-7" = "",
              "Colon 2_Cluster-8" = "",
              "Colon 2_Cluster-9" = "Possibly monocytes (CD14)",
              "Colon 2_Cluster-10" = "Possibly monocytes (CD14)",
              "Colon 2_Cluster-11" = "",
              "Colon 2_Cluster-12" = "Maybe also some monocytes",
              "Colon 2_Cluster-13" = "",
              "Colon 2_Cluster-14" = "",
              "Colon 2_Cluster-15" = "",
              
              "Eyes_Cluster-0" = "",
              "Eyes_Cluster-1" = "",
              "Eyes_Cluster-2" = "",
              "Eyes_Cluster-3" = "",
              "Eyes_Cluster-4" = "",
              "Eyes_Cluster-5" = "",
              "Eyes_Cluster-6" = "",
              "Eyes_Cluster-7" = "",
              "Eyes_Cluster-8" = "",
              "Eyes_Cluster-9" = "",
              "Eyes_Cluster-10" = "",
              "Eyes_Cluster-11" = "",
              
              "Eyes macula_Cluster-0" = "",
              "Eyes macula_Cluster-1" = "",
              "Eyes macula_Cluster-2" = "",
              "Eyes macula_Cluster-3" = "",
              "Eyes macula_Cluster-4" = "",
              "Eyes macula_Cluster-5" = "",
              "Eyes macula_Cluster-6" = "",
              "Eyes macula_Cluster-7" = "",
              "Eyes macula_Cluster-8" = "Or monocyte",
              "Eyes macula_Cluster-9" = "",
              "Eyes macula_Cluster-10" = "",
              "Eyes macula_Cluster-11" = "",
              "Eyes macula_Cluster-12" = "",
              
              "Eyes peripheral_Cluster-0" = "",
              "Eyes peripheral_Cluster-1" = "",
              "Eyes peripheral_Cluster-2" = "",
              "Eyes peripheral_Cluster-3" = "",
              "Eyes peripheral_Cluster-4" = "",
              "Eyes peripheral_Cluster-5" = "",
              "Eyes peripheral_Cluster-6" = "",
              "Eyes peripheral_Cluster-7" = "",
              "Eyes peripheral_Cluster-8" = "B-cell and monocyte mix?",
              "Eyes peripheral_Cluster-9" = "",
              "Eyes peripheral_Cluster-10" = "",
              "Eyes peripheral_Cluster-11" = "",
              
              "Head and neck lymph nodes_Cluster-0" = "",
              "Head and neck lymph nodes_Cluster-1" = "",
              "Head and neck lymph nodes_Cluster-2" = "",
              "Head and neck lymph nodes_Cluster-3" = "",
              "Head and neck lymph nodes_Cluster-4" = "Not sure at all",
              "Head and neck lymph nodes_Cluster-5" = "",
              "Head and neck lymph nodes_Cluster-6" = "",
              "Head and neck lymph nodes_Cluster-7" = "",
              "Head and neck lymph nodes_Cluster-8" = "",
              "Head and neck lymph nodes_Cluster-9" = "",
              "Head and neck lymph nodes_Cluster-10" = "Not sure at all",
              "Head and neck lymph nodes_Cluster-11" = "Not sure at all",
              
              "Heart_Cluster-0" = "",
              "Heart_Cluster-1" = "",
              "Heart_Cluster-2" = "",
              "Heart_Cluster-3" = "",
              "Heart_Cluster-4" = "Maybe mixed with immune cells",
              "Heart_Cluster-5" = "",
              "Heart_Cluster-6" = "",
              "Heart_Cluster-7" = "",
              "Heart_Cluster-8" = "",
              "Heart_Cluster-9" = "",
              
              "Ileum_Cluster-0" = "",
              "Ileum_Cluster-1" = "",
              "Ileum_Cluster-2" = "",
              "Ileum_Cluster-3" = "",
              "Ileum_Cluster-4" = "",
              "Ileum_Cluster-5" = "",
              "Ileum_Cluster-6" = "",
              "Ileum_Cluster-7" = "",
              "Ileum_Cluster-8" = "",
              "Ileum_Cluster-9" = "",
              "Ileum_Cluster-10" = "",
              "Ileum_Cluster-11" = "",
              
              "Kidney_Cluster-0" = "",
              "Kidney_Cluster-1" = "",
              "Kidney_Cluster-2" = "",
              "Kidney_Cluster-3" = "",
              "Kidney_Cluster-4" = "",
              "Kidney_Cluster-5" = "",
              "Kidney_Cluster-6" = "",
              "Kidney_Cluster-7" = "",
              "Kidney_Cluster-8" = "",
              "Kidney_Cluster-9" = "",
              "Kidney_Cluster-10" = "",
              "Kidney_Cluster-11" = "",
              
              "Liver_Cluster-0" = "",
              "Liver_Cluster-1" = "",
              "Liver_Cluster-2" = "",
              "Liver_Cluster-3" = "",
              "Liver_Cluster-4" = "",
              "Liver_Cluster-5" = "",
              "Liver_Cluster-6" = "",
              "Liver_Cluster-7" = "",
              "Liver_Cluster-8" = "",
              "Liver_Cluster-9" = "",
              "Liver_Cluster-10" = "",
              "Liver_Cluster-11" = "",
              "Liver_Cluster-12" = "",
              "Liver_Cluster-13" = "",
              "Liver_Cluster-14" = "",
              "Liver_Cluster-15" = "",
              "Liver_Cluster-16" = "",
              "Liver_Cluster-17" = "",
              
              "Liver hep- CD45-_Cluster-0" = "",
              "Liver hep- CD45-_Cluster-1" = "",
              "Liver hep- CD45-_Cluster-2" = "",
              "Liver hep- CD45-_Cluster-3" = "",
              "Liver hep- CD45-_Cluster-4" = "",
              "Liver hep- CD45-_Cluster-5" = "",
              "Liver hep- CD45-_Cluster-6" = "",
              "Liver hep- CD45-_Cluster-7" = "",
              "Liver hep- CD45-_Cluster-8" = "",
              "Liver hep- CD45-_Cluster-9" = "",
              "Liver hep- CD45-_Cluster-10" = "",
              "Liver hep- CD45-_Cluster-11" = "",
              "Liver hep- CD45-_Cluster-12" = "",
              "Liver hep- CD45-_Cluster-13" = "",
              "Liver hep- CD45-_Cluster-14" = "",
              "Liver hep- CD45-_Cluster-15" = "",
              
              "Liver hep- CD45+_Cluster-0" = "",
              "Liver hep- CD45+_Cluster-1" = "",
              "Liver hep- CD45+_Cluster-2" = "",
              "Liver hep- CD45+_Cluster-3" = "",
              "Liver hep- CD45+_Cluster-4" = "",
              "Liver hep- CD45+_Cluster-5" = "",
              "Liver hep- CD45+_Cluster-6" = "",
              "Liver hep- CD45+_Cluster-7" = "",
              "Liver hep- CD45+_Cluster-8" = "",
              "Liver hep- CD45+_Cluster-9" = "",
              "Liver hep- CD45+_Cluster-10" = "",
              "Liver hep- CD45+_Cluster-11" = "",
              "Liver hep- CD45+_Cluster-12" = "",
              "Liver hep- CD45+_Cluster-13" = "",
              "Liver hep- CD45+_Cluster-14" = "",
              
              "Lung_Cluster-0" = "",
              "Lung_Cluster-1" = "",
              "Lung_Cluster-2" = "",
              "Lung_Cluster-3" = "Could contain granulocytes too",
              "Lung_Cluster-4" = "",
              "Lung_Cluster-5" = "",
              "Lung_Cluster-6" = "",
              "Lung_Cluster-7" = "",
              "Lung_Cluster-8" = "",
              "Lung_Cluster-9" = "",
              "Lung_Cluster-10" = "",
              
              "Muscle_Cluster-0" = "",
              "Muscle_Cluster-1" = "",
              "Muscle_Cluster-2" = "",
              "Muscle_Cluster-3" = "",
              "Muscle_Cluster-4" = "",
              "Muscle_Cluster-5" = "",
              "Muscle_Cluster-6" = "",
              "Muscle_Cluster-7" = "",
              
              "NK cells blood_Cluster-0" = "",
              "NK cells blood_Cluster-1" = "",
              "NK cells blood_Cluster-2" = "",
              "NK cells blood_Cluster-3" = "",
              "NK cells blood_Cluster-4" = "",
              "NK cells blood_Cluster-5" = "",
              
              "NK cells bone marrow_Cluster-0" = "",
              "NK cells bone marrow_Cluster-1" = "",
              "NK cells bone marrow_Cluster-2" = "",
              "NK cells bone marrow_Cluster-3" = "",
              "NK cells bone marrow_Cluster-4" = "",
              "NK cells bone marrow_Cluster-5" = "",
              "NK cells bone marrow_Cluster-6" = "",
              "NK cells bone marrow_Cluster-7" = "",
              "NK cells bone marrow_Cluster-8" = "",
              
              "PBMCs_Cluster-0" = "Monocyte",
              "PBMCs_Cluster-1" = "",
              "PBMCs_Cluster-2" = "Possibly MAIT T-cells - high KLRB1",
              "PBMCs_Cluster-3" = "",
              "PBMCs_Cluster-4" = "",
              "PBMCs_Cluster-5" = "T-cell and possibly NK-cell mix. Maybe also DC",
              "PBMCs_Cluster-6" = "T-cell",
              "PBMCs_Cluster-7" = "",
              "PBMCs_Cluster-8" = "",
              "PBMCs_Cluster-9" = "Remove - Too few cells",
              "PBMCs_Cluster-10" = "Probably dendritic cells based on classification. Likely plasmacytoid DC - has low CD11c (ITGAX)",
              "PBMCs_Cluster-11" = "Remove - Too few cells",
              
              "Placenta_Cluster-0" = "",
              "Placenta_Cluster-1" = "",
              "Placenta_Cluster-2" = "",
              "Placenta_Cluster-3" = "",
              "Placenta_Cluster-4" = "",
              "Placenta_Cluster-5" = "",
              "Placenta_Cluster-6" = "",
              "Placenta_Cluster-7" = "",
              "Placenta_Cluster-8" = "",
              "Placenta_Cluster-9" = "",
              "Placenta_Cluster-10" = "",
              "Placenta_Cluster-11" = "",
              "Placenta_Cluster-12" = "",
              "Placenta_Cluster-13" = "",
              "Placenta_Cluster-14" = "",
              "Placenta_Cluster-15" = "",
              "Placenta_Cluster-16" = "",
              "Placenta_Cluster-17" = "",
              "Placenta_Cluster-18" = "",
              "Placenta_Cluster-19" = "",
              "Placenta_Cluster-20" = "",
              
              "Placenta blood_Cluster-0" = "",
              "Placenta blood_Cluster-1" = "",
              "Placenta blood_Cluster-2" = "T-cell and possibly NK-cell mix. Maybe also DC",
              "Placenta blood_Cluster-3" = "",
              "Placenta blood_Cluster-4" = "Possibly MAIT T-cells - high KLRB1",
              "Placenta blood_Cluster-5" = "",
              "Placenta blood_Cluster-6" = "",
              "Placenta blood_Cluster-7" = "Monocytes and/or dendritic based on classification. Possibly Non-classical monocytes based on low CD14",
              "Placenta blood_Cluster-8" = "T-cell and possibly NK-cell mix. Maybe also DC",
              "Placenta blood_Cluster-9" = "Likely gdT-cell - has low CD8 and CD4",
              "Placenta blood_Cluster-10" = "Possibly dendritic cells based on classification. Likely plasmacytoid DC - has low CD11c (ITGAX)",
              "Placenta blood_Cluster-11" = "possibly granulocyte contamination based on classification",
              
              "Prostate_Cluster-0" = "",
              "Prostate_Cluster-1" = "",
              "Prostate_Cluster-2" = "",
              "Prostate_Cluster-3" = "",
              "Prostate_Cluster-4" = "",
              "Prostate_Cluster-5" = "",
              "Prostate_Cluster-6" = "",
              "Prostate_Cluster-7" = "",
              "Prostate_Cluster-8" = "",
              "Prostate_Cluster-9" = "",
              "Prostate_Cluster-10" = "",
              "Prostate_Cluster-11" = "",
              "Prostate_Cluster-12" = "",
              "Prostate_Cluster-13" = "",
              "Prostate_Cluster-14" = "",
              "Prostate_Cluster-15" = "",
              
              "Prostate 2_Cluster-0" = "",
              "Prostate 2_Cluster-1" = "",
              "Prostate 2_Cluster-2" = "",
              "Prostate 2_Cluster-3" = "",
              "Prostate 2_Cluster-4" = "",
              "Prostate 2_Cluster-5" = "",
              "Prostate 2_Cluster-6" = "",
              "Prostate 2_Cluster-7" = "",
              "Prostate 2_Cluster-8" = "",
              "Prostate 2_Cluster-9" = "",
              "Prostate 2_Cluster-10" = "",
              "Prostate 2_Cluster-11" = "",
              "Prostate 2_Cluster-12" = "",
              
              "Prostate 3_Cluster-0" = "",
              "Prostate 3_Cluster-1" = "",
              "Prostate 3_Cluster-2" = "",
              "Prostate 3_Cluster-3" = "",
              "Prostate 3_Cluster-4" = "",
              "Prostate 3_Cluster-5" = "",
              "Prostate 3_Cluster-6" = "",
              "Prostate 3_Cluster-7" = "",
              "Prostate 3_Cluster-8" = "",
              "Prostate 3_Cluster-9" = "",
              "Prostate 3_Cluster-10" = "",
              "Prostate 3_Cluster-11" = "",
              "Prostate 3_Cluster-12" = "",
              "Prostate 3_Cluster-13" = "",
              "Prostate 3_Cluster-14" = "",
              "Prostate 3_Cluster-15" = "",
              "Prostate 3_Cluster-16" = "",
              
              "Rectum_Cluster-0" = "",
              "Rectum_Cluster-1" = "",
              "Rectum_Cluster-2" = "",
              "Rectum_Cluster-3" = "",
              "Rectum_Cluster-4" = "",
              "Rectum_Cluster-5" = "",
              "Rectum_Cluster-6" = "",
              "Rectum_Cluster-7" = "",
              "Rectum_Cluster-8" = "",
              "Rectum_Cluster-9" = "",
              "Rectum_Cluster-10" = "",
              "Rectum_Cluster-11" = "",
              
              "Testis_Cluster-0" = "",
              "Testis_Cluster-1" = "",
              "Testis_Cluster-2" = "",
              "Testis_Cluster-3" = "",
              "Testis_Cluster-4" = "",
              "Testis_Cluster-5" = "",
              "Testis_Cluster-6" = "",
              "Testis_Cluster-7" = "",
              "Testis_Cluster-8" = "",
              "Testis_Cluster-9" = "",
              "Testis_Cluster-10" = "",
              "Testis_Cluster-11" = "",
              "Testis_Cluster-12" = "",
              "Testis_Cluster-13" = "",
              "Testis_Cluster-14" = "",
              "Testis_Cluster-15" = "",
              "Testis_Cluster-16" = "",
              "Testis_Cluster-17" = "",
              "Testis_Cluster-18" = "",
              "Testis_Cluster-19" = "",
              "Testis_Cluster-20" = "",
              
              "Testis 2_Cluster-0" = "",
              "Testis 2_Cluster-1" = "",
              "Testis 2_Cluster-2" = "",
              "Testis 2_Cluster-3" = "",
              "Testis 2_Cluster-4" = "",
              "Testis 2_Cluster-5" = "",
              "Testis 2_Cluster-6" = "",
              "Testis 2_Cluster-7" = "",
              "Testis 2_Cluster-8" = "",
              "Testis 2_Cluster-9" = "",
              "Testis 2_Cluster-10" = "",
              "Testis 2_Cluster-11" = "",
              "Testis 2_Cluster-12" = "",
              "Testis 2_Cluster-13" = "",
              "Testis 2_Cluster-14" = "",
              "Testis 2_Cluster-15" = "",
              "Testis 2_Cluster-16" = "",
              
              "Testis 3_Cluster-0" = "",
              "Testis 3_Cluster-1" = "",
              "Testis 3_Cluster-2" = "",
              "Testis 3_Cluster-3" = "",
              "Testis 3_Cluster-4" = "",
              "Testis 3_Cluster-5" = "",
              "Testis 3_Cluster-6" = "",
              "Testis 3_Cluster-7" = "",
              "Testis 3_Cluster-8" = "",
              "Testis 3_Cluster-9" = "",
              "Testis 3_Cluster-10" = "",
              "Testis 3_Cluster-11" = "",
              "Testis 3_Cluster-12" = "",
              "Testis 3_Cluster-13" = "") %>% 
              enframe("cluster", "comment")) %>% 
  mutate(dataset_i = unclass(as_factor(dataset)))


cluster_annotation %>% 
  mutate(celltype = ifelse(celltype == "Unknown", "", celltype)) %>%
  select(`dataset number` = dataset_i,
         dataset, 
         cluster = cluster_id,
         `annotation 1 (Max)` = celltype,
         `comment 1 (Max)` = comment) %>% 
  write_csv(savepath("20200305 Cluster annotation Max.csv"))
  
